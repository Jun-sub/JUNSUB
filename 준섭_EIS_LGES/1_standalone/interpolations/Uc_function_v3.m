function [ U ] = Uc_function_v3(soc)
% This function interpolates the equilibrium potential curve of cathode active
% material. Averaging the cuves obtanied in charging and discharging.

type_anode = evalin('base','type_anode');

if type_anode == 0 || type_anode == 1
%% Data: "LGES Natural OCPn upon SOC"
data = [8.52289253439504e-06	3.5300788
1.70457892965422e-05	3.5295439
2.55686860586894e-05	3.528971
3.40915828208365e-05	3.5283602
4.26144795829837e-05	3.5278256
5.11373763451308e-05	3.5269474
6.25012386947024e-05	3.5259352
7.67060666316983e-05	3.5250383
9.65928257435431e-05	3.5238928
0.000127843	3.522442
0.000227277	3.5204957
0.000650581	3.5175968
0.00676718	3.5193666
0.017008861	3.5224401
0.027250542	3.5261201
0.037492223	3.5288991
0.047731063	3.5273219
0.057969903	3.5273275
0.068208743	3.5526727
0.078447583	3.5744651
0.088686423	3.586612
0.098928104	3.5945385
0.109166944	3.6004212
0.119405784	3.6049097
0.129644624	3.6079853
0.139883464	3.610889
0.150122304	3.6140793
0.160358303	3.6178997
0.170597143	3.6232865
0.180833142	3.6307364
0.191071982	3.6392739
0.201307981	3.6480792
0.21154398	3.6553565
0.221779979	3.6619843
0.232015978	3.6683443
0.242251977	3.674953
0.252485135	3.6821726
0.262718293	3.6884757
0.272954292	3.6962107
0.28318745	3.7039075
0.293423449	3.7100194
0.303659448	3.716074
0.313898288	3.7221668
0.324134287	3.7279923
0.334370286	3.7336836
0.344606285	3.7396999
0.354842284	3.7452767
0.365081124	3.7510829
0.375317123	3.7568892
0.385553122	3.7625998
0.395789121	3.7684439
0.406027961	3.7745746
0.416269642	3.7806671
0.426508482	3.78739
0.436744481	3.7942846
0.44698048	3.8015614
0.457222161	3.8092583
0.467463842	3.8177002
0.477705523	3.8265617
0.487947203	3.8359776
0.498188884	3.8458708
0.508427724	3.8559931
0.518669405	3.866154
0.528911086	3.8764101
0.539152767	3.887029
0.549394448	3.8977626
0.559636129	3.9092415
0.56987781	3.9197844
0.580119491	3.9282268
0.590361172	3.9351228
0.600602853	3.9416552
0.610844534	3.9488178
0.621086215	3.9561327
0.631327896	3.9637917
0.641569577	3.9714504
0.651811258	3.9793001
0.662052939	3.9865194
0.672294619	3.9933377
0.682533459	4.0004042
0.692772299	4.0078912
0.703011139	4.015569
0.713249979	4.0239916
0.723488819	4.0330637
0.733727659	4.0432814
0.743966499	4.0540152
0.75420818	4.0656655
0.764449861	4.0779078
0.774691542	4.0901123
0.784933223	4.1022206
0.795174904	4.1136992
0.805416585	4.124261
0.815658266	4.1335621
0.825899947	4.1413737
0.836138787	4.1475232
0.846377627	4.1520689
0.856616467	4.1553731
0.866855307	4.1576455
0.877094147	4.1594985
0.887332987	4.1612366
0.897574668	4.1630316
0.907816349	4.1654189
0.918060871	4.1682652
0.928305392	4.1716073
0.938549914	4.1761148
0.948794436	4.181959
0.959036117	4.1896368
0.969277798	4.1995299
0.979519479	4.2134722
0.989758319	4.2323802
1	4.2592142
];


elseif type_anode == 2

%% Data: "LGES blend cathode OCPp upon SOC"
data = [8.47E-06	3.5288489
1.69E-05	3.528352
2.54E-05	3.5281418
3.39E-05	3.5276449
4.23E-05	3.5273774
5.08E-05	3.5266319
5.93E-05	3.5260394
6.78E-05	3.5254088
7.90E-05	3.5246447
0.000107282	3.5233651
0.000242796	3.5219336
0.001456775	3.5203758
0.011442462	3.5250359
0.021634242	3.5286795
0.031826023	3.5325705
0.042017803	3.5363827
0.052212407	3.5382431
0.062407011	3.5432939
0.072601614	3.5609603
0.082796218	3.5738271
0.092990822	3.5823162
0.103182602	3.5894282
0.113374383	3.5948966
0.12356334	3.5991605
0.133752297	3.6029466
0.143944078	3.6078797
0.154133035	3.6149924
0.164321993	3.6216658
0.17451095	3.6282623
0.18470273	3.6355851
0.194894511	3.6432331
0.205086291	3.650575
0.215278072	3.656636
0.225469852	3.6627543
0.235661633	3.6693886
0.245853413	3.6755069
0.256048017	3.6812428
0.266245444	3.6871315
0.276440048	3.6928673
0.286634651	3.6984692
0.296826432	3.704511
0.307015389	3.7105334
0.317204347	3.7164224
0.327393304	3.7222915
0.337582261	3.7280653
0.347771219	3.7339919
0.357960176	3.7392688
0.368151956	3.7449663
0.378340914	3.7503193
0.388529871	3.7560165
0.398718828	3.7617519
0.408910609	3.7673538
0.419102389	3.7733953
0.42929417	3.7796853
0.439483127	3.7860897
0.449669261	3.7930298
0.459861042	3.8002184
0.470049999	3.8079806
0.48024178	3.8162015
0.49043356	3.8251298
0.500625341	3.8345554
0.510817121	3.8439234
0.521008902	3.8539412
0.531200682	3.8637496
0.541392463	3.8731945
0.551584243	3.8822954
0.561776024	3.8904408
0.571967804	3.8987008
0.582159585	3.9075146
0.592351365	3.9169786
0.602543146	3.9266336
0.612734926	3.9359632
0.622923883	3.9454268
0.633112841	3.9543746
0.643304621	3.9627483
0.653496402	3.9707206
0.663688182	3.9783681
0.673879963	3.9855183
0.684071743	3.9926303
0.694263524	3.9994557
0.704458128	4.006759
0.714649908	4.0145591
0.724844512	4.0227228
0.735036292	4.0317276
0.745228073	4.0418029
0.755419853	4.0527771
0.765608811	4.0643628
0.775797768	4.0766752
0.785986725	4.0891979
0.796175683	4.1016248
0.806367463	4.1136311
0.816559244	4.1240123
0.826751024	4.1335526
0.836945628	4.1415055
0.847140232	4.1480062
0.857334835	4.152633
0.867529439	4.155711
0.877724043	4.1579476
0.887915823	4.1598597
0.898107604	4.1616374
0.908296561	4.1637981
0.918482695	4.1659968
0.928668829	4.1688073
0.938857787	4.1726118
0.949046744	4.1771429
0.959235701	4.1827639
0.969424658	4.1903923
0.979616439	4.2003725
0.989808219	4.2143679
1	4.2352276
];


end 

%% Interpolations
    U = interp1(data(:,1),data(:,2),soc,'linear');
end

