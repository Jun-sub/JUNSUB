function [ U ] = Ua_function_v3(soc)
% -U is for stoi <-> soc adjustment
% This function interpolates the equilibrium potential curve of anode active
% material. Averaging the cuves obtanied in charging and discharging.

type_anode = evalin('base','type_anode');

if type_anode == 0 || type_anode == 1
%% Data: "LGES Natural OCPn upon SOC"
data = [8.52E-06	1.02143996
1.70E-05	1.02130626
2.56E-05	1.02098166
3.41E-05	1.01836543
4.26E-05	1.01582556
5.11E-05	1.01395409
6.25E-05	1.01286559
7.67E-05	1.00797688
9.66E-05	1.00368016
0.000127843	0.99831407
0.000227277	0.98422079
0.000650581	0.94986616
0.00676718	0.69254045
0.017008861	0.5177132
0.027250542	0.4104861
0.037492223	0.3322477
0.047731063	0.2676824
0.057969903	0.2206094
0.068208743	0.2122642
0.078447583	0.2097626
0.088686423	0.2078147
0.098928104	0.2055232
0.109166944	0.2027733
0.119405784	0.1990685
0.129644624	0.1942944
0.139883464	0.1894439
0.150122304	0.1844024
0.160358303	0.1778905
0.170597143	0.1682467
0.180833142	0.160971
0.191071982	0.1561586
0.201307981	0.1514036
0.21154398	0.146935
0.221779979	0.1434021
0.232015978	0.1405186
0.242251977	0.1378451
0.252485135	0.1354579
0.262718293	0.1329182
0.272954292	0.1323071
0.28318745	0.1314095
0.293423449	0.1295189
0.303659448	0.1276474
0.313898288	0.1256423
0.324134287	0.1244202
0.334370286	0.1238854
0.344606285	0.1234653
0.354842284	0.1231407
0.365081124	0.1228924
0.375317123	0.1226442
0.385553122	0.1225487
0.395789121	0.1225105
0.406027961	0.122415
0.416269642	0.1222432
0.426508482	0.1222049
0.436744481	0.1220904
0.44698048	0.1219185
0.457222161	0.1218039
0.467463842	0.1217467
0.477705523	0.1216894
0.487947203	0.1216512
0.498188884	0.1215175
0.508427724	0.1213265
0.518669405	0.1213457
0.528911086	0.1209064
0.539152767	0.1206773
0.549394448	0.1197798
0.559636129	0.1182138
0.56987781	0.1137643
0.580119491	0.1062211
0.590361172	0.0986208
0.600602853	0.0930064
0.610844534	0.0896264
0.621086215	0.0875066
0.631327896	0.0861699
0.641569577	0.0852914
0.651811258	0.0851005
0.662052939	0.0846994
0.672294619	0.0843366
0.682533459	0.0840501
0.692772299	0.0839737
0.703011139	0.0837446
0.713249979	0.0835917
0.723488819	0.083439
0.733727659	0.0834008
0.743966499	0.0831144
0.75420818	0.0830189
0.764449861	0.0827897
0.774691542	0.0825797
0.784933223	0.0825987
0.795174904	0.0824842
0.805416585	0.0825224
0.815658266	0.0825987
0.825899947	0.0825606
0.836138787	0.0823505
0.846377627	0.0823123
0.856616467	0.0821786
0.866855307	0.0821022
0.877094147	0.0818731
0.887332987	0.0816057
0.897574668	0.0813957
0.907816349	0.081243
0.918060871	0.0811475
0.928305392	0.08067
0.938549914	0.0803454
0.948794436	0.0801353
0.959036117	0.0797916
0.969277798	0.0793142
0.979519479	0.078684
0.989758319	0.077882
1	0.0760677
];

elseif type_anode == 2
%% Data: "LGES blending OCPn upon SOC"
data = [8.46961928516831e-06	1.02195107
1.69392429797211e-05	1.02252452
2.54088666742739e-05	1.02099525
3.38784903688267e-05	1.01946597
4.23481140633795e-05	1.0176308
5.08177377579324e-05	1.01617794
5.92873614524852e-05	1.01342522
6.7756985147038e-05	1.01151358
7.90498167398162e-05	1.00639044
0.000107282	0.99673675
0.000242796	0.97393112
0.001456775	0.88775514
0.011442462	0.59242855
0.021634242	0.4585072
0.031826023	0.3693682
0.042017803	0.3033216
0.052212407	0.2515741
0.062407011	0.2206249
0.072601614	0.211927
0.082796218	0.2091169
0.092990822	0.20732
0.103182602	0.2053319
0.113374383	0.2020247
0.12356334	0.1977618
0.133752297	0.1929255
0.143944078	0.1876302
0.154133035	0.1803661
0.164321993	0.1722991
0.17451095	0.1662009
0.18470273	0.1609823
0.194894511	0.1561076
0.205086291	0.1521696
0.215278072	0.1485376
0.225469852	0.1455937
0.235661633	0.1434144
0.245853413	0.1400691
0.256048017	0.1366855
0.266245444	0.1337798
0.276440048	0.1309698
0.286634651	0.1284464
0.296826432	0.126076
0.307015389	0.1245276
0.317204347	0.1235527
0.327393304	0.1228836
0.337582261	0.1223484
0.347771219	0.1222145
0.357960176	0.1218131
0.368151956	0.1217558
0.378340914	0.1215264
0.388529871	0.1214689
0.398718828	0.1214116
0.408910609	0.1211058
0.419102389	0.1209146
0.42929417	0.120819
0.439483127	0.1206853
0.449669261	0.1204558
0.459861042	0.1202838
0.470049999	0.1199971
0.48024178	0.1196912
0.49043356	0.1193471
0.500625341	0.1189839
0.510817121	0.1181618
0.521008902	0.1173016
0.531200682	0.1151033
0.541392463	0.1112036
0.551584243	0.1049526
0.561776024	0.0973061
0.571967804	0.0908831
0.582159585	0.0870407
0.592351365	0.0852055
0.602543146	0.084135
0.612734926	0.0835615
0.622923883	0.0832748
0.633112841	0.083141
0.643304621	0.0828925
0.653496402	0.0825866
0.663688182	0.0824336
0.673879963	0.0822043
0.684071743	0.0821852
0.694263524	0.081994
0.704458128	0.0819557
0.714649908	0.0818602
0.724844512	0.0816117
0.735036292	0.0815926
0.745228073	0.0815351
0.755419853	0.0812485
0.765608811	0.0811338
0.775797768	0.0811338
0.785986725	0.0810191
0.796175683	0.0808088
0.806367463	0.0808661
0.816559244	0.0804646
0.826751024	0.0803309
0.836945628	0.0802544
0.847140232	0.080178
0.857334835	0.0801589
0.867529439	0.0800059
0.877724043	0.0797
0.887915823	0.0794898
0.898107604	0.0792795
0.908296561	0.0788972
0.918482695	0.0784766
0.928668829	0.077884
0.938857787	0.0773488
0.949046744	0.0763356
0.959235701	0.0748636
0.969424658	0.0725123
0.979616439	0.0683641
0.989808219	0.0617691
1	0.0515228
];

end 
%% Interpolations
    U = interp1(data(:,1),data(:,2),soc,'linear');
end

